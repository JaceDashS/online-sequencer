# 개발 전략

**Document Version**: 1.0  
**Software Version**: 0.1.0  
**Last Updated**: 2026-01-14

---

## 서버 구현 접근 방식

콜라보레이션 기능의 서버 구현은 다음 단계로 진행됩니다:

### 1단계: 임시 서버 구현 (현재 프로젝트)

**목적:**
- 클라이언트 기능 개발 및 테스트를 위한 임시 서버
- 프로토타입 및 개념 검증
- 빠른 개발 사이클

**구현 위치:**
- 현재 프로젝트 (`online-daw`) 내부에 임시 서버 폴더 생성
- 예: `server/` 또는 `temp-server/` 디렉토리

**구현 범위:**
- REST API 엔드포인트 (`/api/online-daw/rooms`)
- WebSocket 시그널링 서버 (`/api/online-daw/signaling`)
- 기본 룸 관리 기능
- 6시간 룸 만료 로직
- "Allow Join" 60초 타이머
- 참가자 강퇴 기능

**기술 스택:**
- Node.js + Express (또는 간단한 HTTP 서버)
- WebSocket 라이브러리 (ws 또는 socket.io)
- 인메모리 데이터 저장 (개발 단계)

**장점:**
- 클라이언트와 서버를 같은 프로젝트에서 개발
- 빠른 프로토타이핑 및 테스트
- API 스펙 검증 용이

### 2단계: 실제 서버 프로젝트로 이식

**목적:**
- 프로덕션 환경에 적합한 서버 구현
- 확장성 및 안정성 확보
- 실제 인프라 통합

**이식 과정:**

1. **임시 서버 코드 복사**
   ```bash
   # 임시 서버 폴더를 실제 서버 프로젝트로 복사
   cp -r online-daw/server/ actual-server-project/collaboration/
   ```

2. **코드 리팩토링**
   - 실제 서버 프로젝트의 아키텍처에 맞게 구조 조정
   - 데이터베이스 연동 (Redis, PostgreSQL 등)
   - 인증/인가 시스템 통합
   - 로깅 및 모니터링 추가
   - 에러 핸들링 강화

3. **환경 변수 및 설정**
   - 프로덕션 환경 변수 설정
   - 서버 설정 파일 통합
   - 배포 설정 추가

4. **테스트 및 검증**
   - 기존 테스트 케이스 실행
   - 통합 테스트 수행
   - 성능 테스트

**이식 시 고려사항:**

- **데이터 저장소 변경**
  - 인메모리 → Redis 또는 데이터베이스
  - 룸 정보 영구 저장 (Spot 인스턴스 대응)

- **인증/인가 통합**
  - 기존 서버의 인증 시스템과 통합
  - 호스트/게스트 권한 관리

- **로깅 및 모니터링**
  - 서버 프로젝트의 로깅 시스템 통합
  - 메트릭 수집 및 알림 설정

- **보안 강화**
  - Rate limiting 적용
- CORS 설정
- 입력 검증 강화

## 개발 워크플로우

```
1. 임시 서버 구현 (현재 프로젝트)
   ├─ 서버 폴더 생성
   ├─ 기본 API 구현
   ├─ 클라이언트와 통합 테스트
   └─ API 스펙 검증

2. 클라이언트 기능 개발
   ├─ SignalingClient 구현
   ├─ WebRTCManager 구현
   ├─ SyncManager 구현
   └─ 임시 서버와 통합 테스트

3. 실제 서버 프로젝트로 이식
   ├─ 임시 서버 코드 복사
   ├─ 프로젝트 구조에 맞게 리팩토링
   ├─ 데이터베이스 연동
   ├─ 인증/인가 통합
   └─ 프로덕션 배포

4. 최종 테스트 및 안정화
   ├─ 통합 테스트
   ├─ 성능 테스트
   ├─ 보안 테스트
   └─ 버그 수정 및 최적화
```

### 임시 서버 구조 예시

```
online-daw/
├── server/                    # 임시 서버 (나중에 이식)
│   ├── src/
│   │   ├── routes/
│   │   │   ├── rooms.ts       # REST API 엔드포인트
│   │   │   └── signaling.ts   # WebSocket 시그널링
│   │   ├── services/
│   │   │   ├── roomService.ts # 룸 관리 로직
│   │   │   └── signalingService.ts
│   │   ├── models/
│   │   │   └── room.ts        # 룸 데이터 모델
│   │   └── server.ts          # 서버 진입점
│   ├── package.json
│   └── tsconfig.json
├── src/                       # 클라이언트 코드
└── ...
```

## 이식 시 체크리스트

**코드 이식:**
- [ ] 임시 서버 폴더를 실제 서버 프로젝트로 복사
- [ ] 프로젝트 구조에 맞게 디렉토리 재구성
- [ ] 의존성 패키지 설치 및 버전 확인
- [ ] 타입스크립트 설정 통합

**기능 통합:**
- [ ] 데이터 저장소 변경 (인메모리 → DB/Redis)
- [ ] 인증/인가 시스템 통합
- [ ] 로깅 시스템 통합
- [ ] 에러 핸들링 강화

**설정 및 배포:**
- [ ] 환경 변수 설정
- [ ] 서버 설정 파일 통합
- [ ] 배포 스크립트 추가
- [ ] 헬스 체크 엔드포인트 추가

**테스트:**
- [ ] 단위 테스트 실행
- [ ] 통합 테스트 실행
- [ ] API 엔드포인트 테스트
- [ ] 클라이언트와 통합 테스트

**문서화:**
- [ ] API 문서 업데이트
- [ ] 배포 가이드 작성
- [ ] 운영 매뉴얼 작성

## 주의사항

1. **임시 서버는 개발용**
   - 프로덕션 환경에서 사용하지 않음
   - 보안 및 성능 최적화는 실제 서버에서 수행

2. **API 스펙 일관성 유지**
   - 임시 서버와 실제 서버의 API 스펙이 동일해야 함
   - 클라이언트 코드 변경 최소화

3. **데이터 호환성**
   - 임시 서버의 데이터 구조를 실제 서버로 마이그레이션 가능하도록 설계
   - 또는 임시 서버는 인메모리만 사용 (데이터 손실 허용)

4. **버전 관리**
   - 임시 서버 코드도 Git에 커밋하여 추적
   - 이식 후 실제 서버 프로젝트에서도 버전 관리

---
