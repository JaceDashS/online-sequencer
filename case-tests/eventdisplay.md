# 이벤트 디스플레이 케이스 테스트

## 범위
- 이벤트 디스플레이의 MIDI 파트 생성/편집
- 더블클릭 및 히스토리(Undo/Redo) 동작
- 파트 삭제/복구 시 노트 보존

## 환경
- 브라우저: Chromium 계열, Firefox
- OS: Windows
- 앱: Vite 개발 서버

## 테스트 데이터
- 트랙 2개 이상이 있는 프로젝트
- 이벤트 디스플레이가 보이는 상태

## 테스트 케이스

### ED-001 더블클릭 자체는 히스토리에 기록되지 않음
사전조건: 이벤트 디스플레이에 MIDI 파트가 존재
절차:
1. MIDI 파트를 더블클릭하여 편집 상태로 들어간다
2. Ctrl+Z 또는 Cmd+Z를 누른다
기대결과:
- 더블클릭 자체는 히스토리에 기록되지 않아, Undo만으로 편집 진입이 되돌려지지 않는다

### ED-002 파트 삭제/Undo/Redo 후 노트 보존
사전조건: 새 MIDI 파트를 생성할 수 있는 상태
절차:
1. 이벤트 디스플레이에서 MIDI 파트를 생성한다
2. 생성한 MIDI 파트에 노트를 입력한다
3. MIDI 파트를 Undo 또는 Delete로 삭제한다
4. Redo 또는 Undo로 복구한다
기대결과:
- 복구된 MIDI 파트의 노트가 그대로 유지된다

### ED-003 타임라인과 트랙 리스트 스크롤 동기화
사전조건: 스크롤이 필요한 만큼 트랙 존재
절차:
1. 이벤트 디스플레이(타임라인)를 스크롤한다
기대결과:
- 트랙 리스트 스크롤 위치가 동기화된다

### ED-004 여러 MIDI 파트 삭제 후 Undo 복구 일괄성
사전조건: MIDI 파트가 2개 이상 선택 가능한 상태
절차:
1. 여러 MIDI 파트를 동시에 선택한다
2. Delete 또는 Backspace로 삭제한다
3. Ctrl+Z 또는 Cmd+Z로 Undo 한다
기대결과:
- 삭제된 MIDI 파트가 한 번에 모두 복구된다

### ED-005 Split 상태 해제 (1/3/4)
사전조건: 이벤트 디스플레이에서 Split 모드가 활성화된 상태
절차:
1. 1 키를 누른다
2. 3 키를 눌러 Split을 다시 켠다
3. 3 키를 다시 누른다
4. 3 키를 눌러 Split을 다시 켠다
5. 4 키를 누른다
기대결과:
- 1 키 입력 시 Split 모드가 해제된다
- 3 키 입력 시 Split 모드가 토글되어 해제된다
- 4 키 입력 시 Split 모드가 해제된다 (Merge 활성화)

### ED-006 Merge 상태 해제 (1/4/3)
사전조건: 이벤트 디스플레이에서 Merge 모드가 활성화된 상태
절차:
1. 1 키를 누른다
2. 4 키를 눌러 Merge를 다시 켠다
3. 4 키를 다시 누른다
4. 4 키를 눌러 Merge를 다시 켠다
5. 3 키를 누른다
기대결과:
- 1 키 입력 시 Merge 모드가 해제된다
- 4 키 입력 시 Merge 모드가 토글되어 해제된다
- 3 키 입력 시 Merge 모드가 해제된다 (Split 활성화)

### ED-007 Quantize 상태에서 Split 미리보기/절단 위치 스냅
사전조건: Quantize가 활성화되어 있고 Split 모드를 사용할 수 있는 상태
절차:
1. Quantize를 활성화한다
2. Split 모드를 활성화한다
3. MIDI 파트 위에서 마우스를 이동한다
4. 여러 위치에서 Split 미리보기 라인을 확인한다
5. Split을 실행한다
기대결과:
- Split 미리보기와 실제 절단 위치가 Quantize 그리드에 스냅된다

### ED-008 Split -> Quantize -> Split 재토글 시 커서 모드 해제
사전조건: 이벤트 디스플레이가 활성화된 상태
절차:
1. 3 키를 눌러 Split 모드를 켠다
2. Q 키를 눌러 Quantize를 토글한다
3. 3 키를 다시 눌러 Split 모드를 토글한다
기대결과:
- 커서 모드가 null(기본 상태)로 돌아간다

### ED-009 축고정 모드: Alt 이동 스냅
사전조건: 이벤트 디스플레이에서 MIDI 파트를 드래그할 수 있는 상태
절차:
1. MIDI 파트를 클릭해 그립 상태로 만든다
2. Alt를 누른 채 대각선으로 드래그한다
기대결과:
- 이동이 상하 또는 좌우 축으로 스냅된다
- 더 많이 이동한 축 방향으로 스냅된다

### ED-010 축고정 모드: Ctrl+Alt 복제 이동
사전조건: 이벤트 디스플레이에서 MIDI 파트를 드래그할 수 있는 상태
절차:
1. MIDI 파트를 클릭해 그립 상태로 만든다
2. Ctrl+Alt를 누른 채 드래그한다
기대결과:
- MIDI 파트가 복제되면서 축고정 스냅이 적용된다

### ED-011 축고정 모드: Ctrl 유지 + Alt 토글
사전조건: 이벤트 디스플레이에서 MIDI 파트를 드래그할 수 있는 상태
절차:
1. Ctrl을 누른 상태로 드래그를 시작한다
2. 드래그 중 Alt를 여러 번 눌렀다 뗀다
기대결과:
- 축고정 모드가 정상적으로 동작한다
- Ctrl이 눌려 있어도 축고정이 적용된다

### ED-012 축고정 모드: 그립 이동 중 다른 MIDI 파트 Split 방지
사전조건: 이벤트 디스플레이에 MIDI 파트가 2개 이상 존재하고 Split 모드가 활성화되어 있음
절차:
1. MIDI 파트를 클릭해 그립 상태로 만든다
2. Alt를 누른 채 드래그해 다른 MIDI 파트 위로 이동한다
기대결과:
- 다른 MIDI 파트에 Split 미리보기 라인이 나타나지 않는다
- 다른 MIDI 파트가 분할되지 않는다

### ED-013 Merge: 감싸는 파트의 끝점 유지
사전조건: 이벤트 디스플레이에 같은 트랙에 속한 MIDI 파트 2개가 존재하며, 파트1이 파트2를 감싸고 있음 (파트1의 시작 < 파트2의 시작, 파트1의 끝 > 파트2의 끝)
절차:
1. Merge 모드를 활성화한다 (4 키)
2. 파트1과 파트2를 모두 선택한다
3. Merge를 실행한다
기대결과:
- 병합된 파트의 시작점은 파트1의 시작점이다
- 병합된 파트의 끝점은 파트1의 끝점이다 (파트2의 끝점이 아님)
- 두 파트의 모든 노트가 병합된 파트에 포함된다

### ED-014 Merge: 다중 선택 시 가장 먼저인 점과 가장 나중인 점 기준
사전조건: 이벤트 디스플레이에 같은 트랙에 속한 MIDI 파트 3개 이상이 존재
절차:
1. Merge 모드를 활성화한다 (4 키)
2. 여러 파트를 선택한다 (예: 파트1, 파트2, 파트3)
3. Merge를 실행한다
기대결과:
- 병합된 파트의 시작점은 선택된 파트들 중 가장 먼저인 점(가장 작은 시작점)이다
- 병합된 파트의 끝점은 선택된 파트들 중 가장 나중인 점(가장 큰 끝점)이다
- 모든 선택된 파트의 노트가 병합된 파트에 포함된다
- 원본 파트들은 삭제되고 하나의 병합된 파트만 남는다

### ED-015 Merge: 감싸는 파트와 다중 선택 조합
사전조건: 이벤트 디스플레이에 같은 트랙에 속한 MIDI 파트 3개 이상이 존재하며, 파트1이 파트2를 감싸고 있고, 파트3은 파트1과 겹치지 않음
절차:
1. Merge 모드를 활성화한다 (4 키)
2. 파트1, 파트2, 파트3을 모두 선택한다
3. Merge를 실행한다
기대결과:
- 병합된 파트의 시작점은 가장 먼저인 점(파트1의 시작점 또는 파트3의 시작점 중 작은 값)이다
- 병합된 파트의 끝점은 가장 나중인 점(파트1의 끝점 또는 파트3의 끝점 중 큰 값)이다
- 파트1이 파트2를 감싸고 있어도, 파트3의 끝점이 더 나중이면 파트3의 끝점이 병합된 파트의 끝점이 된다
- 모든 선택된 파트의 노트가 병합된 파트에 포함된다

### ED-016 여러 개 선택 후 그립: 모든 선택된 파트 드래그
사전조건: 이벤트 디스플레이에 같은 트랙에 속한 MIDI 파트 2개 이상이 존재
절차:
1. Ctrl 키를 누른 상태에서 여러 MIDI 파트를 선택한다 (예: 파트1, 파트2, 파트3)
2. Ctrl 키를 떼고 선택된 파트 중 하나(예: 파트2)를 클릭하여 그립을 잡는다
3. 드래그하여 다른 위치로 이동한다
4. 마우스를 놓는다
기대결과:
- 선택된 모든 파트(파트1, 파트2, 파트3)가 함께 드래그된다
- 모든 파트가 동일한 오프셋만큼 이동한다
- 파트 간 상대 위치가 유지된다

### ED-017 여러 개 선택 후 비선택 파트 클릭: 단일 선택으로 변경
사전조건: 이벤트 디스플레이에 같은 트랙에 속한 MIDI 파트 2개 이상이 존재
절차:
1. Ctrl 키를 누른 상태에서 여러 MIDI 파트를 선택한다 (예: 파트1, 파트2)
2. Ctrl 키를 떼고 선택되지 않은 다른 파트(예: 파트3)를 클릭한다
3. 드래그하여 다른 위치로 이동한다
4. 마우스를 놓는다
기대결과:
- 파트3만 선택되고 드래그된다
- 이전에 선택되었던 파트1, 파트2는 선택 해제된다
- 파트3만 이동한다

### ED-018 다중 클론 후 언두: 모든 클론된 파트가 한 번에 제거
사전조건: 이벤트 디스플레이에 같은 트랙에 속한 MIDI 파트 2개 이상이 존재
절차:
1. Ctrl 키를 누른 상태에서 여러 MIDI 파트를 선택한다 (예: 파트1, 파트2)
2. Ctrl 키를 누른 상태에서 선택된 파트들을 드래그하여 다른 위치로 이동한다 (클론)
3. 클론된 파트들이 생성되었는지 확인한다 (예: 파트3, 파트4)
4. Ctrl+Z 또는 Cmd+Z로 Undo 한다
기대결과:
- 언두 한 번에 모든 클론된 파트(파트3, 파트4)가 동시에 제거된다
- 원본 파트(파트1, 파트2)는 그대로 유지된다
- 한 번 더 언두를 해야 하는 것이 아니라 한 번의 언두로 모든 클론이 제거된다

### ED-019 다중 트랙 클론 미리보기: 모든 트랙의 미리보기 표시
사전조건: 이벤트 디스플레이에 서로 다른 트랙에 속한 MIDI 파트 2개 이상이 존재 (예: 트랙1의 파트1, 트랙2의 파트2)
절차:
1. Ctrl 키를 누른 상태에서 서로 다른 트랙의 MIDI 파트를 선택한다 (예: 트랙1의 파트1, 트랙2의 파트2)
2. Ctrl 키를 누른 상태에서 선택된 파트들을 드래그하여 다른 위치로 이동한다 (클론)
3. 드래그 중에 각 트랙에서 미리보기가 표시되는지 확인한다
기대결과:
- 트랙1에서 파트1의 미리보기가 표시된다
- 트랙2에서 파트2의 미리보기가 표시된다
- 모든 선택된 파트의 미리보기가 각각의 트랙에 올바르게 표시된다
- 미리보기가 표시되지 않는 트랙이 없어야 한다

### ED-020 MIDI 파트 선택 후 다른 트랙 선택 시 포커스 유지
사전조건: 이벤트 디스플레이에 여러 트랙이 존재하고, 최소 하나의 트랙에 MIDI 파트가 존재
절차:
1. MIDI 파트를 클릭하여 선택한다 (예: 트랙1의 파트1)
2. 믹서 또는 트랙 컨트롤에서 다른 트랙을 선택한다 (예: 트랙2)
3. 선택된 트랙이 유지되는지 확인한다
기대결과:
- MIDI 파트가 선택된 상태에서도 사용자가 선택한 트랙(트랙2)의 포커스가 유지된다
- 트랙 포커스가 강제로 MIDI 파트가 있는 트랙(트랙1)으로 돌아가지 않는다
- MIDI 파트 선택 상태는 유지되지만, 트랙 포커스는 사용자가 명시적으로 선택한 트랙에 유지된다

### ED-021 MIDI 파트 클릭 시 해당 트랙으로 포커스 이동
사전조건: 이벤트 디스플레이에 여러 트랙이 존재하고, 최소 하나의 트랙에 MIDI 파트가 존재
절차:
1. 다른 트랙을 선택한다 (예: 트랙2)
2. MIDI 파트를 클릭하여 선택한다 (예: 트랙1의 파트1)
3. 트랙 포커스가 변경되는지 확인한다
기대결과:
- MIDI 파트를 클릭하면 해당 파트가 속한 트랙(트랙1)으로 포커스가 이동한다
- 사용자가 MIDI 파트를 직접 클릭한 경우에만 트랙 포커스가 변경된다